function showWishlistModal(t,e,n={}){if(document.querySelector(".wishlist-quick-view-modal-wrapper"))return;if(!window.WishlistUtils)return void console.error("No utility object (WishlistUtils) found.");const i=t.featuredImage.url||"https://via.placeholder.com/100",s=`/products/${t.handle}`||"#",o=t.title||"Unknown Product",a=t.images,r=Array.isArray(a)?a:a&&a.edges?a.edges.map((t=>t.node)):[{url:i,altText:"No description available"}];let l=0;if(t.rating&&"string"==typeof t.rating.value)try{const e=JSON.parse(t.rating.value);l=parseFloat(e.value)||0}catch(t){l=0}let c=0;t.reviewCount&&"string"==typeof t.reviewCount.value&&(c=parseInt(t.reviewCount.value,10)||0),t.rating=l,t.ratingCount=c;const d=t.variants.edges&&t.variants.edges.length>0&&t.variants.edges[0].node.selectedOptions?t.variants.edges[0].node.selectedOptions.map((t=>t.name)):[],u=d.map(((e,n)=>{const i=[...new Set(t.variants.edges.map((t=>(t.node.selectedOptions||[]).find((t=>t.name===e))?.value)).filter(Boolean))];return`\n  <div class="wishlist-variant-group" data-option-index="${n}">\n    <div class="wishlist-variant-label">${e}:</div>\n    <div class="wishlist-variant-buttons">\n      ${i.map(((i,s)=>`\n            <button type="button" class="wishlist-variant-btn${!(t.variants.edges||[]).some((t=>(t.node.selectedOptions||[]).some((t=>t.name===e&&t.value===i))&&!1!==t.node.availableForSale))?" wishlist-variant-btn-soldout":""}" data-option-index="${n}" data-value="${i}">${i}</button>\n          `)).join("")}\n    </div>\n  </div>\n`})).join("");document.body.style.overflow="hidden";const h=document.createElement("div"),w=document.createElement("div");w.className="wishlist-quick-view-modal-wrapper",h.className="wishlist-quick-view-modal-box";const v="buy-now"===e?n.buyNowText:"add-to-cart"===e?n.atcTextRVP:n.atcTextRO;h.innerHTML=`\n    <div class="wishlist-quick-view-modal">\n        <button class="wishlist-close">&times;</button>\n        <div class="wishlist-modal-content">\n            <a class="wishlist-back-to-shop" onclick="document.querySelector('.wishlist-quick-view-modal-wrapper').remove(); document.body.style.overflow = ''">Back to shop</a>\n            <div class="wishlist-quick-view-left-content">\n                <div class="wishlist-thumbnail-carousel-wrapper">\n                  <button class="wishlist-thumb-arrow wishlist-thumb-arrow-up">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M18 15l-6-6-6 6"/></svg>\n                  </button>\n                  <div class="wishlist-quick-view-thumbnails" tabindex="0">\n                    ${r.map(((t,e)=>`\n                        <img \n                        src="${t.url}" \n                        alt="Thumbnail ${e+1}" \n                        class="wishlist-thumbnail-image" data-thumb-index="${e}" \n                        onclick="document.getElementById('wishlist-main-product-image').src='${t.url}'"\n                        />\n                    `)).join("")}\n                  </div>\n                  <button class="wishlist-thumb-arrow wishlist-thumb-arrow-down">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M6 9l6 6 6-6"/></svg>\n                  </button>\n                </div>\n                <div class="wishlist-main-image-carousel-wrapper">\n                  <button class="wishlist-main-arrow wishlist-main-arrow-left">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M15 18l-6-6 6-6"/></svg>\n                  </button>\n                  <div class="wishlist-quick-view-main-image-list" tabindex="0">\n                    ${r.map(((t,e)=>`\n                      <img src="${t.url}" alt="${o}" class="wishlist-main-image-item" data-main-index="${e}" draggable="false" />\n                    `)).join("")}\n                  </div>\n                  <button class="wishlist-main-arrow wishlist-main-arrow-right">\n                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="3" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18l6-6-6-6"/></svg>\n                  </button>\n                </div>\n            </div>\n            <div class="wishlist-quick-view-right-content">\n                <a class="wishlist-quick-view-product-title" href="${s}">\n                    ${o}\n                </a>\n                ${t.rating&&t.ratingCount?`\n                <div class="wishlist-quick-view-reviews">\n                    <span class="wishlist-qv-reviews-badge__stars" data-score="${t.rating}">\n                        ${renderStars(t.rating)}\n                    </span>\n                    <span class="wishlist-qv-reviews-badge__text">\n                        <strong>${t.ratingCount} Review${1==t.ratingCount?"":"s"}</strong>\n                    </span>\n                </div>\n                `:""}\n                 <a href="${s}" target="_blank" class="wishlist-view-details">view full details</a>\n\n                <div class="wishlist-price-wrapper" id="wishlist-quick-view-price-wrapper">\n                  <div class="wishlist-compare-at-row">\n                    <span id="wishlist-quick-view-compare-price" class="wishlist-compare-at-price"></span>\n                  </div>\n                  <div class="wishlist-price-row">\n                    <span id="wishlist-quick-view-price"></span>\n                    <span class="wishlist-vertical-separator">|</span>\n                    <span id="wishlist-quick-view-discount-badge" class="wishlist-discount-inline" style="display:none"></span>\n                  </div>\n                </div>\n                <form id="wishlist-quick-view-form">\n                    <div id="wishlist-quick-view-soldout-message" style="display:none; color:#000; font-weight:bold; margin-bottom:8px;">Sold out</div>\n                    <div class="wishlist-variants-dropdown-wrapper">\n                    ${u}\n                    </div>\n                    <div class="wishlist-add-to-cart-container">\n                        <div class="wishlist-quantity-selector">\n                            <button type="button" id="wishlist-decrement-qty">-</button>\n                            <input type="number" id="wishlist-quick-view-quantity" name="quantity" value="1" min="1" autocomplete="off" />\n                            <button type="button" id="wishlist-increment-qty">+</button>\n                        </div>\n                        <button type="submit" class="wishlist-add-to-cart-button">\n                          <span class="wishlist-add-to-cart-text">${v}</span>\n                        </button>\n                    </div>\n                </form>\n            </div>\n        </div>\n    </div>\n  `,w.appendChild(h),document.body.appendChild(w);const p=h.querySelector(".wishlist-thumb-arrow-up"),m=h.querySelector(".wishlist-thumb-arrow-down"),y=h.querySelector(".wishlist-quick-view-thumbnails"),g=Array.from(y?y.querySelectorAll(".wishlist-thumbnail-image"):[]);p&&m&&y&&(g.length<=5?(p.style.display="none",m.style.display="none",y.style.overflowY="hidden",y.style.maxHeight="none"):(p.style.display="",m.style.display="",y.style.overflowY="auto",y.style.maxHeight="400px")),p.addEventListener("click",(()=>{y.scrollBy({top:-thumbImageHeight,behavior:"smooth"})})),m.addEventListener("click",(()=>{y.scrollBy({top:thumbImageHeight,behavior:"smooth"})}));const b=h.querySelector(".wishlist-quick-view-main-image-list"),f=Array.from(b.querySelectorAll(".wishlist-main-image-item")),q=h.querySelector(".wishlist-main-arrow-left"),x=h.querySelector(".wishlist-main-arrow-right");let S,k=0;function C(t){k=t;f[k].scrollIntoView({behavior:"smooth",inline:"center",block:"nearest"})}q.addEventListener("click",(()=>{k>0&&C(k-1)})),x.addEventListener("click",(()=>{k<f.length-1&&C(k+1)})),b.addEventListener("scroll",(()=>{clearTimeout(S),S=setTimeout((()=>{const t=b.getBoundingClientRect();let e=1/0,n=0;f.forEach(((i,s)=>{const o=i.getBoundingClientRect(),a=Math.abs(o.left+o.width/2-(t.left+t.width/2));a<e&&(e=a,n=s)})),C(n)}),100)})),g.forEach(((t,e)=>{t.addEventListener("click",(()=>C(e)))})),C(0);const E=h.querySelector("#wishlist-quick-view-quantity");h.querySelector("#wishlist-decrement-qty").addEventListener("click",(function(){let t=parseInt(E.value,10)||1;t>1&&(E.value=t-1)})),h.querySelector("#wishlist-increment-qty").addEventListener("click",(function(){let t=parseInt(E.value,10)||1;E.value=t+1})),h.querySelector("#wishlist-quick-view-form").addEventListener("submit",(function(n){n.preventDefault();const i=(t.variants.edges||[]).find((t=>!!t.node.selectedOptions&&L.every((e=>t.node.selectedOptions.some((t=>t.name===e.name&&t.value===e.value))))))||t.variants.edges[0],s=i.node.id?i.node.id.split("/").pop():null,o=(parseInt(E.value,10),h.querySelector(".wishlist-add-to-cart-button"));if(!s||!o)return;const a=o.querySelector(".wishlist-add-to-cart-text")||o,r=a.textContent;o.disabled=!0,a.classList&&a.classList.contains("wishlist-add-to-cart-text"),a.textContent="reorder"===e||"buy-now"===e?"Processing...":"Adding...",fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:s,quantity:E.value})}).then((()=>{fetch("?section_id=cart-drawer").then((t=>t.text())).then((t=>{const e=(new DOMParser).parseFromString(t,"text/html").querySelector("cart-drawer"),n=document.querySelector("cart-drawer");if(e){n?n.replaceWith(e):document.body.appendChild(e),e.querySelectorAll("script").forEach((t=>{const e=document.createElement("script");t.src?(e.src=t.src,e.async=!1):e.textContent=t.textContent,document.body.appendChild(e).remove()}));const t=document.querySelector("cart-drawer");t&&"function"==typeof t.open?t.open():document.documentElement.classList.add("cart--open")}updateCartCount()}));const t=document.querySelector(".wishlist-quick-view-modal-wrapper");t&&(t.remove(),document.body.style.overflow=""),setTimeout((()=>{a.textContent=r,o.disabled=!1}),2e3)})).catch((t=>{console.error("Error adding item to cart:",t),a.textContent="Error",setTimeout((()=>{a.textContent=r,o.disabled=!1}),2e3)}))})),h.querySelector(".wishlist-close").addEventListener("click",(()=>{h.remove(),w.remove(),document.body.style.overflow=""})),w.addEventListener("click",(t=>{t.target===w&&(h.remove(),w.remove(),document.body.style.overflow="")}));const T=h.querySelectorAll(".wishlist-variant-group"),$=(t.variants.edges||[]).find((t=>!1!==t.node.availableForSale))||t.variants.edges[0];let L=d.map(((t,e)=>{const n=($.node.selectedOptions||[]).find((e=>e.name===t));return{name:t,value:n?n.value:""}}));function O(){T.forEach(((t,e)=>{t.querySelectorAll(".wishlist-variant-btn").forEach((t=>{L[e].value===t.textContent?t.classList.add("selected"):t.classList.remove("selected")}))}))}function A(){const e=h.querySelector(".wishlist-add-to-cart-button"),n=L.some((t=>!t.value)),i=e.querySelector(".wishlist-add-to-cart-text");if(n){e.disabled=!0,i&&(i.textContent="MAKE A SELECTION"),e.style.opacity="0.7",e.style.pointerEvents="none";const n=h.querySelector("#wishlist-quick-view-soldout-message");n&&(n.style.display="none");const s=h.querySelector(".wishlist-quick-view-product-title");if(s){const e=L.filter((t=>t.value)).map((t=>t.value));e.length>0?s.textContent=t.title+" - "+e.join(" - "):s.textContent=t.title}return}const s=(t.variants.edges||[]).find((t=>!!t.node.selectedOptions&&L.every((e=>t.node.selectedOptions.some((t=>t.name===e.name&&t.value===e.value))))))||t.variants.edges[0];let o="",a="";if(s.node.presentmentPrices&&s.node.presentmentPrices.edges&&s.node.presentmentPrices.edges.length>0){const t=s.node.presentmentPrices.edges[0].node;o=t.price.amount,a=t.compareAtPrice?t.compareAtPrice.amount:""}const r=h.querySelector("#wishlist-quick-view-soldout-message");!1===s.node.availableForSale?r.style.display="":r.style.display="none";const l=h.querySelector("#wishlist-quick-view-price"),c=h.querySelector("#wishlist-quick-view-compare-price"),d=h.querySelector("#wishlist-quick-view-discount-badge"),u=h.querySelector(".wishlist-vertical-separator");if(l.textContent=window.CurrencyUtils.formatMoneyCurrency(String(o),window.money_format),a&&a!==o){c.textContent=window.CurrencyUtils.formatMoneyCurrency(String(a),window.money_format),c.style.display="",u&&(u.style.display="");const t=function(t,e){return!e||e<=t?null:Math.round((e-t)/e*100)}(parseFloat(o),parseFloat(a));t&&t>0?(d.textContent=`${t}% OFF`,d.className="wishlist-discount-inline",d.style.display=""):d.style.display="none"}else c.textContent="",c.style.display="none",d.style.display="none",u&&(u.style.display="none");!1===s.node.availableForSale?(e.disabled=!0,i&&(i.textContent="Sold Out"),e.style.opacity="0.5",e.style.pointerEvents="none"):(e.disabled=!1,i&&(i.textContent=v),e.style.opacity="",e.style.pointerEvents="");const w=h.querySelector(".wishlist-quick-view-product-title");if(w&&s){let e=t.title;const n=t.variants.edges[0]?.node?.title,i=formatVariantTitle(s.node.title);n&&"Default Title"!==n&&e.endsWith(" - "+n)&&(e=e.slice(0,-(" - "+n).length)),w.textContent=i&&"Default Title"!==i?e+" - "+i:e}}T.forEach(((t,e)=>{t.querySelectorAll(".wishlist-variant-btn").forEach((t=>{t.addEventListener("click",(()=>{L[e].value===t.textContent?L[e].value="":L[e].value=t.textContent,O(),A()}))}))})),O(),A()}function formatVariantTitle(t){return t&&t.includes(" / ")?t.replace(/ \/ /g," - "):t}function renderStars(t=0){let e="";const n=Math.round(2*t)/2;for(let t=1;t<=5;t++)e+=t<=n?'<span class="wishlist-qv-star wishlist-qv-star--on">★</span>':t-.5===n?'<span class="wishlist-qv-star wishlist-qv-star--half"><span class="wishlist-qv-star__half--on">★</span><span class="wishlist-qv-star__half--off">★</span></span>':'<span class="wishlist-qv-star wishlist-qv-star--off">★</span>';return e}function updateCartCount(){fetch("/cart.js").then((t=>t.json())).then((t=>{const e=document.querySelector("#cart-icon-bubble"),n=e.querySelector(".cart-count-bubble"),i=t.item_count||0;if(!n&&i>0){const t=document.createElement("div");t.className="cart-count-bubble",t.innerHTML=`\n          <span aria-hidden="true">${i}</span>\n          <span class="visually-hidden">${i} item${i>1?"s":""}</span>\n        `,e.appendChild(t);const n=e.querySelector("svg");n.classList.remove("icon-cart-empty"),n.classList.add("icon-cart"),n.innerHTML='\n          <path fill="currentColor" fill-rule="evenodd" d="M20.5 6.5a4.75 4.75 0 00-4.75 4.75v.56h-3.16l-.77 11.6a5 5 0 004.99 5.34h7.38a5 5 0 004.99-5.33l-.77-11.6h-3.16v-.57A4.75 4.75 0 0020.5 6.5zm3.75 5.31v-.56a3.75 3.75 0 10-7.5 0v.56h7.5zm-7.5 1h7.5v.56a3.75 3.75 0 11-7.5 0v-.56zm-1 0v.56a4.75 4.75 0 109.5 0v-.56h2.22l.71 10.67a4 4 0 01-3.99 4.27h-7.38a4 4 0 01-4-4.27l.72-10.67h2.22z"></path>\n        '}else n&&(n.querySelector('span[aria-hidden="true"]').textContent=i,n.querySelector(".visually-hidden").textContent=`${i} item${i>1?"s":""}`)})).catch((t=>{console.error("Error updating cart count:",t)}))}document.body.addEventListener("click",(function(t){if(t.target.closest(".quick-view-btn")){const e=t.target.closest(".quick-view-btn"),n=e.getAttribute("data-product"),i=e.getAttribute("data-title"),s=e.getAttribute("data-action")||"add-to-cart",o="true"===e.getAttribute("data-has-variants");if(!n)return void console.error("No product data found on button");if(!o){try{const t=JSON.parse(n),i=t.variants?.edges?.[0]?.node?.id?.split("/").pop();if(!i)return;const o=e.querySelector(".wishlist-atc-button-text")||e;o.dataset.originalText||(o.dataset.originalText=o.textContent);const a=o.dataset.originalText;if(o.textContent="reorder"===s||"buy-now"===s?"Processing...":"Adding...",e.disabled=!0,"reorder"===s||"buy-now"===s)fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:i,quantity:1})}).then((()=>{window.location.href="/checkout"}));else{if("true"===e.dataset.addingToCart)return;e.dataset.addingToCart="true",fetch("/cart/add.js",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:i,quantity:1})}).then((()=>{fetch("?section_id=cart-drawer").then((t=>t.text())).then((t=>{const e=(new DOMParser).parseFromString(t,"text/html").querySelector("cart-drawer"),n=document.querySelector("cart-drawer");if(e){n?n.replaceWith(e):document.body.appendChild(e),e.querySelectorAll("script").forEach((t=>{const e=document.createElement("script");t.src?(e.src=t.src,e.async=!1):e.textContent=t.textContent,document.body.appendChild(e).remove()}));const t=document.querySelector("cart-drawer");t&&"function"==typeof t.open?t.open():document.documentElement.classList.add("cart--open")}updateCartCount()}));const t=document.querySelector(".wishlist-quick-view-modal-wrapper");t&&(t.remove(),document.body.style.overflow=""),setTimeout((()=>{o.textContent=a,e.disabled=!1,e.dataset.addingToCart="false"}),2e3)})).catch((t=>{console.error("Error adding item to cart:",t),o.textContent="Error",setTimeout((()=>{o.textContent=a,e.disabled=!1,e.dataset.addingToCart="false"}),2e3)}))}}catch(t){console.error("Error parsing product data:",t)}return}let a=e.querySelector(".wishlist-atc-button-text")?.textContent.trim()||"",r=e.querySelector(".wishlist-buy-now-button-text")?.textContent.trim()||"";try{const t=JSON.parse(n),e=decodeURIComponent(i);showWishlistModal({...t,title:e},s,{atcTextRVP:a,buyNowText:r})}catch(t){console.error("Error parsing product data:",t)}}}));